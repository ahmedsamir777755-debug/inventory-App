<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inventory Control</title>

  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <style>
    body {
      font-family: Arial;
      padding: 20px;
    }
    table {
      border-collapse: collapse;
      margin-top: 20px;
      width: 100%;
    }
    th, td {
      border: 1px solid #999;
      padding: 6px;
      text-align: center;
    }
    th {
      background: #f0f0f0;
    }
  </style>
</head>
<body>

<h2>Inventory Excel Upload</h2>

<input type="file" id="fileInput" accept=".xlsx,.xls">
<button onclick="loadFile()">Load File</button>

<div id="table"></div>

<script>
function loadFile() {

  const fileInput = document.getElementById("fileInput");
  if (!fileInput.files.length) {
    alert("اختار ملف الأول");
    return;
  }

  const reader = new FileReader();

  reader.onload = function(e) {

    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, { type: "array" });

    const sheetName = workbook.SheetNames[0];
    const sheet = workbook.Sheets[sheetName];

    const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });

    renderTable(json);
  };

  reader.readAsArrayBuffer(fileInput.files[0]);
}

function renderTable(data) {
  let html = "<table>";

  data.forEach((row, index) => {
    html += "<tr>";
    row.forEach(cell => {
      html += index === 0
        ? `<th>${cell ?? ""}</th>`
        : `<td>${cell ?? ""}</td>`;
    });
    html += "</tr>";
  });

  html += "</table>";
  document.getElementById("table").innerHTML = html;
}
</script>

</body>
</html>
